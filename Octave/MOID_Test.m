# Results from Research Paper
# http://moid.cbk.waw.pl/orbity/static/MOID.pdf
#                q           e        i (deg)  Omega (deg)  w (deg)     Actual MOID       D-min
Asteroids = [2.55343183, 0.0777898,  10.58785,  80.35052,  72.14554, 0.13455874348909, 0.1346719; ...
             2.12995319, 0.2313469,  34.84268, 173.12520, 310.03850, 0.00289925623680, 0.0151316; ...
             1.98948966, 0.2552218,  12.97943, 169.90317, 248.22602, 0.07817951779390, 0.0784614; ...
             2.15354370, 0.0882196,   7.13426, 103.89537, 150.08873, 0.08735595371552, 0.0878071; ...
             2.08388391, 0.1905003,   5.36719, 141.60955, 358.80654, 0.14532630925408, 0.1455354; ...
             2.48391159, 0.9543470, 119.29902,  39.00301, 357.90012, 0.26938418933051, 0.2709789; ...
             2.36382356, 0.9006860, 160.41316, 297.34820, 102.45000, 0.54491059333263, 0.5479893; ...
             0.13964163, 0.8901393,  22.23224, 265.28749, 322.11933, 0.70855959609279, 0.7152397; ...
             0.35420623, 0.8363753,  11.68912,  28.13011, 208.66724, 0.03943927946198, 0.1120682; ...
             0.52469070, 0.7715449,  12.56792,   7.25167, 122.30952, 0.18225709092897, 0.2183000; ...
             2.74144856, 0.1153501,   0.00431, 272.90217, 251.43828, 0.14766834758223, 0.1483890; ...
             2.50571901, 0.1924270,   0.01522,  94.14405, 304.71343, 0.00010493251317, 0.0102467; ...
             2.11312640, 0.1215091,   0.02244, 321.26045, 109.96758, 0.00030783183432, 0.0141584; ...
             2.09876663, 0.1543590,   0.02731,  88.64817,  67.91991, 0.00098583168214, 0.0084652; ...
             2.67112178, 0.1328536,   0.02809,  41.39822, 274.65080, 0.20707625146740, 0.2087313; ...
             1.99601821, 0.1875129,   1.26622, 238.06043,  31.32645, 0.00000003815330, 0.0069443; ...
             2.03086844, 0.1653922,   0.66023, 339.21518,  89.47548, 0.00000419348257, 0.0011561; ...
             1.77550824, 0.1928808,   3.43901, 140.55651, 216.20834, 0.00000627704688, 0.0402762; ...
             1.96745453, 0.1837814,   3.69269,  98.95749, 227.52626, 0.00000785853673, 0.0043333; ...
             2.15731280, 0.1007470,   2.91058, 138.77805, 231.93187, 0.00001189165231, 0.0100350];

% convert the original date to radians             
Asteroids(:,3:5) = deg2rad(Asteroids(:,3:5));

% calculate the semi-major axis
Asteroids(:,8) = Asteroids(:,1) ./ (1 - Asteroids(:,2));

% create the target body             
Target = [2.036, .164, 0, 0, deg2rad(250.227), 2.036 / (1 - .164)];
             
% start the timer
tic;

% perform the calculation on all 20 test cases
for testNum = 1:20             

    semiMajorAxis = [Target(6); Asteroids(testNum, 8)];
    eccentricity  = [Target(2); Asteroids(testNum, 2)];
    inclination   = [Target(3); Asteroids(testNum, 3)];
    RAAN          = [Target(4); Asteroids(testNum, 4)];
    argPeriapsis  = [Target(5); Asteroids(testNum, 5)];

    [MOID_c(testNum), Dmin_sq(testNum)] = MOID_WisRic (semiMajorAxis, eccentricity, argPeriapsis, RAAN, inclination);

end

% stop the timer
elapsed_time = toc;

% take the SQRT to get the actual distances
Dmin_c = sqrt(Dmin_sq);  

% print out the results
printf(" Test\tMOID - Calc\t\tMOID - Actual\t\tDmin-Calc\tDmin-Actual\n");
for i = 1:20
    printf("%d\t%16.14f\t%16.14f\t%10.8f\t%10.8f\n", i, MOID_c(i), Asteroids(i,6), Dmin_c(i), Asteroids(i,7));
end

% output the elapsed time in seconds
printf("\nTime Elapsed for 20 test cases: %8.6f seconds\n", elapsed_time);